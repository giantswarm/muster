name: "mcpserver-create-remote-validation"
description: "Test validation for remote MCP server creation and mixed configuration detection"
category: "behavioral"
concept: "mcpserver"
tags: ["mcpserver", "create", "remote", "validation", "mixed-config", "core-api"]
timeout: "2m"

steps:
- id: "create-remote-mcpserver-missing-remote-config"
  description: "Try to create a remote MCP server without remote configuration (should fail)"
  tool: "core_mcpserver_create"
  args:
    name: "remote-missing-config"
    type: "remote"
  expected:
    success: false
    error_contains: ["remote configuration", "required"]

- id: "create-remote-mcpserver-missing-endpoint"
  description: "Try to create a remote MCP server without endpoint (should fail)"
  tool: "core_mcpserver_create"
  args:
    name: "remote-missing-endpoint"
    type: "remote"
    remote:
      transport: "http"
  expected:
    success: false
    error_contains: ["endpoint", "required"]

- id: "create-remote-mcpserver-missing-transport"
  description: "Try to create a remote MCP server without transport (should fail)"
  tool: "core_mcpserver_create"
  args:
    name: "remote-missing-transport"
    type: "remote"
    remote:
      endpoint: "http://localhost:8080/mcp"
  expected:
    success: false
    error_contains: ["transport", "required"]

- id: "create-remote-mcpserver-invalid-transport"
  description: "Try to create a remote MCP server with invalid transport (should fail)"
  tool: "core_mcpserver_create"
  args:
    name: "remote-invalid-transport"
    type: "remote"
    remote:
      endpoint: "http://localhost:8080/mcp"
      transport: "invalid-transport"
  expected:
    success: false
    error_contains: ["transport", "invalid"]

- id: "create-remote-mcpserver-with-local-config"
  description: "Try to create a remote MCP server with local configuration (should fail)"
  tool: "core_mcpserver_create"
  args:
    name: "remote-with-local-config"
    type: "remote"
    local:
      command: ["echo", "test"]
      autoStart: false
  expected:
    success: false
    error_contains: ["remote configuration", "required"]

- id: "create-local-mcpserver-with-remote-config"
  description: "Try to create a local MCP server with remote configuration (should fail)"
  tool: "core_mcpserver_create"
  args:
    name: "local-with-remote-config"
    type: "local"
    remote:
      endpoint: "http://localhost:8080/mcp"
      transport: "http"
  expected:
    success: false
    error_contains: ["local configuration", "required"]

- id: "create-valid-remote-mcpserver"
  description: "Create a valid remote MCP server to ensure validation passes"
  tool: "core_mcpserver_create"
  args:
    name: "valid-remote-server"
    type: "remote"
    remote:
      endpoint: "http://localhost:8080/mcp"
      transport: "http"
      timeout: 30
  expected:
    success: true

cleanup:
- id: "delete-valid-remote-mcpserver"
  description: "Clean up the valid remote MCP server"
  tool: "core_mcpserver_delete"
  args:
    name: "valid-remote-server"
  expected:
    success: true 

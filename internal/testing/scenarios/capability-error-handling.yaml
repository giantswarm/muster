name: "capability-error-handling-scenarios"
category: "behavioral"
concept: "capability"
tags: ["capability", "error-handling", "validation", "core-api"]
timeout: "3m"

steps:
- id: "create-capability-missing-name"
  tool: "core_capability_create"
  args:
    type: "test"
    operations:
      test_operation:
        description: "Test operation for missing name test"
        requires: []
  expected:
    success: false
    error_contains: ["name", "required"]

- id: "create-capability-missing-type"
  tool: "core_capability_create"
  args:
    name: "missing-type-capability"
    operations:
      test_operation:
        description: "Test operation for missing type test"
        requires: []
  expected:
    success: false
    error_contains: ["type", "required"]

- id: "create-capability-missing-operations"
  tool: "core_capability_create"
  args:
    name: "missing-operations-capability"
    type: "test"
  expected:
    success: false
    error_contains: ["must have at least one operation"]

- id: "delete-non-existent-capability"
  tool: "core_capability_delete"
  args:
    name: "non-existent-capability"
  expected:
    success: false
    error_contains: ["not found"]

- id: "get-non-existent-capability"
  tool: "core_capability_get"
  args:
    name: "non-existent-capability"
  expected:
    success: false
    error_contains: ["not found"]

- id: "update-non-existent-capability"
  tool: "core_capability_update"
  args:
    name: "non-existent-capability"
    description: "Trying to update a capability that doesn't exist"
  expected:
    success: false
    error_contains: ["not found"]

- id: "create-capability-duplicate-name"
  tool: "core_capability_create"
  args:
    name: "duplicate-capability"
    type: "test"
    operations:
      test_operation:
        description: "Test operation for duplicate name test"
        requires: []
  expected:
    success: true
  cleanup:
    - tool: "core_capability_delete"
      args: { name: "duplicate-capability" }

- id: "create-capability-duplicate-name-again"
  tool: "core_capability_create"
  args:
    name: "duplicate-capability"
    type: "test"
    operations:
      test_operation:
        description: "Test operation for duplicate name test"
        requires: []
  expected:
    success: false
    error_contains: ["already exists"] 